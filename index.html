<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Decoder Ring</title>
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Internal Styles -->
    <style>
        /* ===== General Body & Scrollbar Styling ===== */
        body { 
            font-family: 'Inter', sans-serif;
            background-color: #0d1117;
            overflow: hidden;
            background-image: radial-gradient(circle at top left, rgba(59, 130, 246, 0.15), transparent 40%),
                              radial-gradient(circle at bottom right, rgba(99, 102, 241, 0.15), transparent 40%);
        }
        .overflow-y-auto::-webkit-scrollbar { width: 8px; }
        .overflow-y-auto::-webkit-scrollbar-track { background: transparent; }
        .overflow-y-auto::-webkit-scrollbar-thumb { background-color: #3b82f6; border-radius: 20px; }

        /* ===== Typography & Font Styles ===== */
        h1, h2, .output-table .key, textarea, input[type="text"], input[type="number"] {
            font-family: 'Roboto Mono', monospace;
        }
        .gradient-text { 
            background: linear-gradient(to right, #3b82f6, #818cf8, #3b82f6); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
            background-size: 200% auto;
            animation: shimmer 5s linear infinite;
        }

        /* ===== Card & Layout Styling ===== */
        .glass-card {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.2);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        /* ===== Interactive Elements (Tabs, Buttons, Inputs) ===== */
        input[type="radio"]:checked { background-color: #3b82f6; }
        input[type="radio"]:disabled { cursor: not-allowed; }
        .tab-button { 
            padding: 0.75rem 1rem; 
            cursor: pointer; 
            border: none; 
            background: none; 
            color: #94a3b8; 
            font-weight: 600; 
            transition: all 0.2s ease-in-out; 
            border-bottom: 3px solid transparent; 
            white-space: nowrap; 
            display: flex; 
            align-items: center; 
            gap: 0.5rem; 
        }
        .tab-button:hover { 
            color: #ffffff;
            transform: translateY(-2px);
        }
        .tab-button.active { 
            color: #3b82f6; 
            border-bottom-color: #3b82f6; 
        }
        .tab-button svg { width: 1.25rem; height: 1.25rem; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        .action-btn { transition: all 0.2s ease-in-out; }
        .action-btn:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
        }
        #file-drop-zone { border: 2px dashed #475569; }
        #file-drop-zone.dragover { border-color: #3b82f6; background-color: rgba(59, 130, 246, 0.1); }
        
        /* ===== Table Styling ===== */
        .output-table table { width: 100%; text-align: left; border-collapse: collapse; }
        .output-table th, .output-table td { padding: 0.75rem; border: 1px solid #1e293b; }
        .output-table tr:nth-child(even) { background-color: rgba(59, 130, 246, 0.05); }
        .output-table .value { word-break: break-all; font-family: 'Inter', sans-serif; }

        /* ===== Animations ===== */
        @keyframes shimmer {
            to { background-position: -200% center; }
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-300 min-h-screen p-4 sm:p-6 md:p-8">

    <!-- Main Container -->
    <div class="w-full max-w-7xl mx-auto h-[calc(100vh-2rem)] sm:h-[calc(100vh-4rem)] flex flex-col z-10">
        
        <!-- Header Section -->
        <header class="text-center mb-6 shrink-0">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold gradient-text">Decode, Inspect, Secure</h1>
            <p class="text-slate-400 mt-2 text-sm sm:text-base">Develop by Mr Vk</p>
        </header>

        <!-- Tab Navigation -->
        <div class="border-b border-blue-900/50 mb-6 shrink-0">
            <div class="flex overflow-x-auto">
                <button class="tab-button active" data-tab="encoder"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" /></svg>Encoder/Decoder</button>
                <button class="tab-button" data-tab="jwt"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" /></svg>JWT Inspector</button>
                <button class="tab-button" data-tab="timestamp"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>Timestamp</button>
                <button class="tab-button" data-tab="url-parser"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" /></svg>URL Parser</button>
                <button class="tab-button" data-tab="ip-subnet"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418" /></svg>IP Subnet</button>
                <button class="tab-button" data-tab="dns-lookup"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21.75c5.385 0 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25 2.25 6.615 2.25 12s4.365 9.75 9.75 9.75z" /><path stroke-linecap="round" stroke-linejoin="round" d="M12 8.25v6.75" /><path stroke-linecap="round" stroke-linejoin="round" d="M12 15.75h.008v.008H12v-.008z" /></svg>DNS Lookup</button>
                <button class="tab-button" data-tab="exif-viewer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" /><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" /></svg>EXIF Viewer</button>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="flex-grow overflow-y-auto pr-2">
            
            <!-- Encoder/Decoder Tab -->
            <div id="encoder" class="tab-content active">
                <div class="glass-card p-4 rounded-xl mb-6 flex flex-col items-center space-y-4">
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-4 w-full flex-wrap">
                        <div class="flex items-center gap-2">
                            <label for="algorithm" class="font-semibold text-lg text-blue-400">Algorithm:</label>
                            <select id="algorithm" class="bg-slate-800 border border-slate-600 text-white text-md rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 block p-2.5">
                                <optgroup label="Two-Way Operations"><option value="base64">Base64</option><option value="url">URL</option><option value="html">HTML Entities</option><option value="caesar">Caesar Cipher</option></optgroup>
                                <optgroup label="One-Way Hashing"><option value="md5">MD5</option><option value="sha1">SHA-1</option><option value="sha256">SHA-256</option><option value="sha512">SHA-512</option></optgroup>
                                <optgroup label="Self-Inverting"><option value="rot13">ROT13 Cipher</option></optgroup>
                            </select>
                        </div>
                        <div id="action-container" class="flex items-center gap-4 p-2.5 bg-slate-800/80 rounded-lg">
                            <label class="flex items-center cursor-pointer"><input type="radio" name="action" value="encode" class="form-radio h-4 w-4 bg-slate-600 border-slate-500" checked><span class="ml-2 text-blue-400 font-semibold">Encode</span></label>
                            <label class="flex items-center cursor-pointer"><input type="radio" name="action" value="decode" class="form-radio h-4 w-4 bg-slate-600 border-slate-500"><span class="ml-2 text-blue-400 font-semibold">Decode</span></label>
                        </div>
                    </div>
                    <div id="caesar-shift-container" class="hidden text-center w-full mt-4">
                        <label for="caesar-shift" class="font-semibold text-lg mr-2 text-blue-400">Shift Value:</label>
                        <input type="number" id="caesar-shift" value="3" min="1" max="25" class="bg-slate-800 border border-slate-600 rounded-lg p-2 w-24 text-center">
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="glass-card p-6 rounded-xl">
                        <h2 class="text-2xl font-semibold mb-4 text-blue-400">Input</h2>
                        <textarea id="inputText" class="w-full h-64 sm:h-80 bg-slate-900 border-2 border-slate-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none transition-colors" placeholder="Yahan apna text daalo..."></textarea>
                    </div>
                    <div class="glass-card p-6 rounded-xl">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-semibold text-blue-400">Output</h2>
                            <button id="copyButton" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg action-btn">Copy</button>
                        </div>
                        <textarea id="outputText" class="w-full h-64 sm:h-80 bg-slate-900 border-2 border-slate-700 rounded-md p-3 focus:outline-none resize-none" readonly placeholder="Result yahan dikhega..."></textarea>
                    </div>
                </div>
            </div>
            
            <!-- JWT Inspector Tab -->
            <div id="jwt" class="tab-content">
                <div class="glass-card p-6 rounded-xl">
                    <h2 class="text-2xl font-semibold mb-4 text-blue-400">JWT Input</h2>
                    <textarea id="jwtInput" class="w-full h-32 bg-slate-900 border-2 border-slate-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none transition-colors" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"></textarea>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
                    <div class="glass-card p-6 rounded-xl">
                        <h2 class="text-2xl font-semibold mb-4 text-blue-400">Header (Decoded)</h2>
                        <textarea id="jwtHeaderOutput" class="w-full h-48 bg-slate-900 border-2 border-slate-700 rounded-md p-3 resize-none" readonly></textarea>
                    </div>
                    <div class="glass-card p-6 rounded-xl">
                        <h2 class="text-2xl font-semibold mb-4 text-blue-400">Payload (Decoded)</h2>
                        <textarea id="jwtPayloadOutput" class="w-full h-48 bg-slate-900 border-2 border-slate-700 rounded-md p-3 resize-none" readonly></textarea>
                    </div>
                </div>
            </div>
            
            <!-- Timestamp Converter Tab -->
            <div id="timestamp" class="tab-content">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="glass-card p-6 rounded-xl">
                        <h2 class="text-2xl font-semibold mb-4 text-blue-400">Unix Timestamp to Human Date</h2>
                        <label for="unixInput" class="font-semibold mb-2 block">Unix Timestamp (seconds):</label>
                        <input id="unixInput" type="number" class="w-full bg-slate-900 border-2 border-slate-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors" placeholder="1678886400">
                        <label for="humanOutput" class="font-semibold mt-4 mb-2 block">Result (UTC):</label>
                        <input id="humanOutput" type="text" class="w-full bg-slate-900 border-2 border-slate-700 rounded-md p-3" readonly>
                    </div>
                    <div class="glass-card p-6 rounded-xl">
                        <h2 class="text-2xl font-semibold mb-4 text-blue-400">Human Date to Unix Timestamp</h2>
                        <label for="humanInput" class="font-semibold mb-2 block">Date/Time String:</label>
                        <input id="humanInput" type="text" class="w-full bg-slate-900 border-2 border-slate-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors" placeholder="2023-03-15T12:00:00Z">
                        <label for="unixOutput" class="font-semibold mt-4 mb-2 block">Result (Unix Timestamp):</label>
                        <input id="unixOutput" type="text" class="w-full bg-slate-900 border-2 border-slate-700 rounded-md p-3" readonly>
                    </div>
                </div>
            </div>
            
            <!-- URL Parser Tab -->
            <div id="url-parser" class="tab-content">
                <div class="glass-card p-6 rounded-xl">
                    <h2 class="text-2xl font-semibold mb-4 text-blue-400">URL to Parse</h2>
                    <textarea id="urlInput" class="w-full h-24 bg-slate-900 border-2 border-slate-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none transition-colors" placeholder="https://www.example.com:8080/path/to/page?param1=value1&param2=value2#section"></textarea>
                    <div id="urlOutput" class="mt-6 output-table"></div>
                </div>
            </div>
            
            <!-- IP Subnet Calculator Tab -->
            <div id="ip-subnet" class="tab-content">
                <div class="glass-card p-6 rounded-xl">
                    <h2 class="text-2xl font-semibold mb-4 text-blue-400">IP Subnet Calculator</h2>
                    <label for="ipInput" class="font-semibold mb-2 block">IP Address with CIDR</label>
                    <input id="ipInput" type="text" class="w-full bg-slate-900 border-2 border-slate-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors" placeholder="192.168.1.10/24">
                    <div id="ipOutput" class="mt-6 output-table"></div>
                </div>
            </div>

            <!-- DNS Lookup Tab -->
            <div id="dns-lookup" class="tab-content">
                <div class="glass-card p-6 rounded-xl">
                    <h2 class="text-2xl font-semibold mb-4 text-blue-400">DNS Lookup</h2>
                    <div class="flex flex-col sm:flex-row gap-4 items-center">
                        <input id="dnsDomainInput" type="text" class="w-full bg-slate-900 border-2 border-slate-700 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors" placeholder="example.com">
                        <select id="dnsTypeSelect" class="bg-slate-800 border border-slate-600 text-white rounded-lg p-3">
                            <option>A</option><option>AAAA</option><option>MX</option><option>TXT</option><option>CNAME</option><option>NS</option>
                        </select>
                        <button id="dnsLookupBtn" class="w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg action-btn">Lookup</button>
                    </div>
                    <div id="dnsOutput" class="w-full mt-6 output-table"></div>
                </div>
            </div>

            <!-- EXIF Viewer Tab -->
            <div id="exif-viewer" class="tab-content">
                <div class="glass-card p-6 rounded-xl">
                    <h2 class="text-2xl font-semibold mb-4 text-blue-400">EXIF Data Viewer</h2>
                    <div id="file-drop-zone" class="w-full p-8 text-center rounded-lg cursor-pointer transition">
                        <input type="file" id="exifFileInput" class="hidden" accept="image/jpeg, image/png">
                        <svg class="mx-auto h-12 w-12 text-slate-500" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>
                        <p class="mt-2 text-slate-400">Drag & drop an image here, or click to select</p>
                        <p class="text-xs text-slate-500">JPEG/PNG files are supported</p>
                    </div>
                    <div id="exifOutput" class="mt-6 output-table"></div>
                </div>
            </div>
        </main>
        
        <!-- Toast Notification -->
        <div id="toast" class="fixed bottom-10 right-10 bg-green-500 text-white py-2 px-4 rounded-lg shadow-lg opacity-0 transform translate-y-4 transition-all duration-300">Copied to clipboard!</div>
    </div>

    <!-- Main Application Script -->
    <script>
    /**
     * Main function to initialize the application after the DOM is loaded.
     */
    document.addEventListener('DOMContentLoaded', () => {
        // Initialize all modules
        setupTabNavigation();
        setupToast();
        setupEncoder();
        setupJWT();
        setupTimestamp();
        setupURLParser();
        setupIPCalculator();
        setupDNSLookup();
        setupEXIFViewer();
    });

    /**
     * Sets up the tab switching functionality.
     */
    function setupTabNavigation() {
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                tabButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                const tabName = button.getAttribute('data-tab');
                tabContents.forEach(content => content.classList.toggle('active', content.id === tabName));
            });
        });
    }

    /**
     * Sets up the toast notification for copy actions.
     */
    function setupToast() {
        const toast = document.getElementById('toast');
        const showToast = (message = 'Copied to clipboard!') => {
            toast.textContent = message;
            toast.classList.remove('opacity-0', 'translate-y-4');
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-4');
            }, 2000);
        };
        
        document.getElementById('copyButton').addEventListener('click', () => { 
            const outputText = document.getElementById('outputText');
            if(outputText.value) { 
                outputText.select(); 
                document.execCommand('copy'); 
                window.getSelection().removeAllRanges(); 
                showToast(); 
            } 
        });
    }
        
    /**
     * Sets up the Encoder/Decoder module.
     */
    function setupEncoder() {
        const inputText = document.getElementById('inputText');
        const outputText = document.getElementById('outputText');
        const algorithmSelect = document.getElementById('algorithm');
        const actionContainer = document.getElementById('action-container');
        const caesarShiftContainer = document.getElementById('caesar-shift-container');
        const caesarShift = document.getElementById('caesar-shift');
        const HASH_ALGOS = ['md5', 'sha1', 'sha256', 'sha512'];
        const SELF_INVERTING_ALGOS = ['rot13'];

        const transformText = () => {
            let t = inputText.value, a = algorithmSelect.value, o = document.querySelector('input[name="action"]:checked')?.value || 'encode', r = '';
            if (!t) { outputText.value = ''; return; }
            try {
                switch (a) {
                    case 'base64': r = o === 'encode' ? btoa(unescape(encodeURIComponent(t))) : decodeURIComponent(escape(atob(t))); break;
                    case 'url': r = o === 'encode' ? encodeURIComponent(t) : decodeURIComponent(t.replace(/\+/g, ' ')); break;
                    case 'html': { const d = document.createElement('div'); if (o === 'encode') { d.innerText = t; r = d.innerHTML; } else { d.innerHTML = t; r = d.innerText; } break; }
                    case 'caesar': { const s = parseInt(caesarShift.value, 10) || 0, d = o === 'encode' ? s : -s; r = t.replace(/[a-zA-Z]/g, c => { const b = c < 'a' ? 65 : 97; return String.fromCharCode(((c.charCodeAt(0) - b + d + 26) % 26) + b); }); break; }
                    case 'md5': r = CryptoJS.MD5(t).toString(); break;
                    case 'sha1': r = CryptoJS.SHA1(t).toString(); break;
                    case 'sha256': r = CryptoJS.SHA256(t).toString(); break;
                    case 'sha512': r = CryptoJS.SHA512(t).toString(); break;
                    case 'rot13': r = t.replace(/[a-zA-Z]/g, c => String.fromCharCode((c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26)); break;
                    default: r = 'Invalid algorithm';
                }
            } catch (e) { r = `Error: Invalid input for this operation.`; }
            outputText.value = r;
        };

        const handleAlgorithmChange = () => {
            const currentAlgo = algorithmSelect.value;
            const encodeRadio = document.querySelector('input[name="action"][value="encode"]');
            const decodeRadio = document.querySelector('input[name="action"][value="decode"]');
            const decodeLabel = decodeRadio.parentElement;
            const isHash = HASH_ALGOS.includes(currentAlgo);
            const isSelfInverting = SELF_INVERTING_ALGOS.includes(currentAlgo);
            actionContainer.classList.toggle('hidden', isSelfInverting);
            if (isHash) {
                decodeRadio.disabled = true;
                decodeLabel.classList.add('opacity-50', 'cursor-not-allowed');
                if (!encodeRadio.checked) encodeRadio.checked = true;
            } else {
                decodeRadio.disabled = false;
                decodeLabel.classList.remove('opacity-50', 'cursor-not-allowed');
            }
            caesarShiftContainer.classList.toggle('hidden', currentAlgo !== 'caesar');
            transformText();
        };

        algorithmSelect.addEventListener('change', handleAlgorithmChange);
        inputText.addEventListener('input', transformText);
        caesarShift.addEventListener('input', transformText);
        document.querySelectorAll('input[name="action"]').forEach(r => r.addEventListener('change', transformText));
        handleAlgorithmChange(); // Initial setup
    }

    /**
     * Sets up the JWT Inspector module.
     */
    function setupJWT() {
        const jwtInput = document.getElementById('jwtInput');
        const jwtHeaderOutput = document.getElementById('jwtHeaderOutput');
        const jwtPayloadOutput = document.getElementById('jwtPayloadOutput');
        
        const decodeJwt = () => {
            const t = jwtInput.value;
            jwtHeaderOutput.value = ''; jwtPayloadOutput.value = '';
            if (!t || t.split('.').length !== 3) { jwtHeaderOutput.value = 'Invalid JWT. Expected three parts separated by dots.'; return; }
            const [h, p] = t.split('.');
            try { jwtHeaderOutput.value = JSON.stringify(JSON.parse(atob(h.replace(/-/g, '+').replace(/_/g, '/'))), null, 2); } catch (e) { jwtHeaderOutput.value = 'Error decoding header.'; }
            try { jwtPayloadOutput.value = JSON.stringify(JSON.parse(atob(p.replace(/-/g, '+').replace(/_/g, '/'))), null, 2); } catch (e) { jwtPayloadOutput.value = 'Error decoding payload.'; }
        };
        jwtInput.addEventListener('input', decodeJwt);
    }

    /**
     * Sets up the Timestamp Converter module.
     */
    function setupTimestamp() {
        const unixInput = document.getElementById('unixInput');
        const humanOutput = document.getElementById('humanOutput');
        const humanInput = document.getElementById('humanInput');
        const unixOutput = document.getElementById('unixOutput');
        unixInput.addEventListener('input', () => { const t = parseInt(unixInput.value, 10); humanOutput.value = !isNaN(t) ? new Date(t * 1000).toUTCString() : ''; });
        humanInput.addEventListener('input', () => { const d = new Date(humanInput.value); unixOutput.value = !isNaN(d.getTime()) ? Math.floor(d.getTime() / 1000) : ''; });
    }

    /**
     * Sets up the URL Parser module.
     */
    function setupURLParser() {
        const urlInput = document.getElementById('urlInput');
        const urlOutput = document.getElementById('urlOutput');
        
        const parseUrl = () => {
            const u = urlInput.value;
            urlOutput.innerHTML = ''; if (!u) return;
            try {
                const t = new URL(u); let p = '';
                t.searchParams.forEach((v, k) => { p += `<tr><td class="key">${k}</td><td class="value">${v}</td></tr>`; });
                const mainDetails = `<table><tbody><tr><td class="key">Protocol</td><td class="value">${t.protocol}</td></tr><tr><td class="key">Hostname</td><td class="value">${t.hostname}</td></tr><tr><td class="key">Port</td><td class="value">${t.port || '(default)'}</td></tr><tr><td class="key">Pathname</td><td class="value">${t.pathname}</td></tr><tr><td class="key">Hash</td><td class="value">${t.hash || '(none)'}</td></tr></tbody></table>`;
                urlOutput.innerHTML = mainDetails + (p ? `<h3 class="text-xl font-semibold mt-6 mb-2 text-blue-400">Query Parameters</h3><table><tbody>${p}</tbody></table>` : '');
            } catch (e) { urlOutput.innerHTML = `<p class="text-red-400">Error: Invalid URL.</p>`; }
        };
        urlInput.addEventListener('input', parseUrl);
        parseUrl(); // Initial call
    }

    /**
     * Sets up the IP Subnet Calculator module.
     */
    function setupIPCalculator() {
        const ipInput = document.getElementById('ipInput');
        const ipOutput = document.getElementById('ipOutput');
        
        const calculateSubnet = () => {
            const input = ipInput.value; ipOutput.innerHTML = '';
            const [ip, cidr] = (input || '').split('/');
            const cidrInt = parseInt(cidr, 10);
            if (!ip || isNaN(cidrInt) || cidrInt < 0 || cidrInt > 32) { if (input) ipOutput.innerHTML = '<p class="text-red-400">Invalid format. Use IP/CIDR (e.g., 192.168.1.1/24).</p>'; return; }
            const ipParts = ip.split('.').map(p => parseInt(p, 10));
            if (ipParts.length !== 4 || ipParts.some(p => isNaN(p) || p < 0 || p > 255)) { ipOutput.innerHTML = '<p class="text-red-400">Invalid IP address.</p>'; return; }
            const ipLong = ipParts.reduce((acc, part) => (acc << 8) + part, 0) >>> 0;
            const mask = (-1 << (32 - cidrInt)) >>> 0;
            const networkLong = ipLong & mask;
            const broadcastLong = networkLong | (~mask >>> 0);
            const longToIp = (long) => [(long >>> 24) & 255, (long >>> 16) & 255, (long >>> 8) & 255, long & 255].join('.');
            const totalHosts = Math.pow(2, 32 - cidrInt);
            const results = { "Network Address": longToIp(networkLong), "Broadcast Address": longToIp(broadcastLong), "Subnet Mask": longToIp(mask), "Total Hosts": totalHosts.toLocaleString(), "Usable Host Range": cidrInt > 30 ? 'N/A' : `${longToIp(networkLong + 1)} - ${longToIp(broadcastLong - 1)}`, "Usable Hosts": (cidrInt <= 30 ? totalHosts - 2 : 0).toLocaleString() };
            ipOutput.innerHTML = `<table><tbody>${Object.entries(results).map(([k, v]) => `<tr><td class="key">${k}</td><td class="value">${v}</td></tr>`).join('')}</tbody></table>`;
        };
        ipInput.addEventListener('input', calculateSubnet);
        calculateSubnet(); // Initial call
    }
        
    /**
     * Sets up the DNS Lookup module.
     */
    function setupDNSLookup() {
        const dnsDomainInput = document.getElementById('dnsDomainInput');
        const dnsTypeSelect = document.getElementById('dnsTypeSelect');
        const dnsLookupBtn = document.getElementById('dnsLookupBtn');
        const dnsOutput = document.getElementById('dnsOutput');
        
        dnsLookupBtn.addEventListener('click', async () => {
            const domain = dnsDomainInput.value, type = dnsTypeSelect.value;
            if (!domain) { dnsOutput.innerHTML = '<p class="text-red-400">Please enter a domain.</p>'; return; }
            dnsOutput.innerHTML = '<p class="text-slate-400">Looking up...</p>';
            dnsLookupBtn.disabled = true; dnsLookupBtn.textContent = 'Searching...'; dnsLookupBtn.classList.add('opacity-50', 'cursor-not-allowed');
            try {
                const response = await fetch(`https://dns.google/resolve?name=${domain}&type=${type}`);
                const data = await response.json();
                if (data.Status !== 0 || !data.Answer) {
                    dnsOutput.innerHTML = `<p class="text-slate-400">No records found for this type.</p>`;
                } else {
                    const rows = data.Answer.map(r => `<tr><td class="value">${r.name}</td><td class="value">${type}</td><td class="value">${r.TTL}</td><td class="value" style="white-space: pre-wrap;">${r.data.replace(/^"|"$/g, '').replace(/""/g, '"')}</td></tr>`).join('');
                    dnsOutput.innerHTML = `<table><thead><tr><th class="key">Name</th><th class="key">Type</th><th class="key">TTL</th><th class="key">Data</th></tr></thead><tbody>${rows}</tbody></table>`;
                }
            } catch (e) { dnsOutput.innerHTML = `<p class="text-red-400">Error: Could not fetch DNS records.</p>`; } 
            finally { dnsLookupBtn.disabled = false; dnsLookupBtn.textContent = 'Lookup'; dnsLookupBtn.classList.remove('opacity-50', 'cursor-not-allowed'); }
        });
    }

    /**
     * Sets up the EXIF Viewer module.
     */
    function setupEXIFViewer() {
        const fileDropZone = document.getElementById('file-drop-zone');
        const exifFileInput = document.getElementById('exifFileInput');
        const exifOutput = document.getElementById('exifOutput');

        const handleExifFile = file => {
            if (typeof EXIF === 'undefined') { exifOutput.innerHTML = `<p class="text-red-400">EXIF library could not be loaded. Please check your internet connection.</p>`; return; }
            if (!file || !file.type.match('image.*')) { exifOutput.innerHTML = `<p class="text-red-400">Please select an image file.</p>`; return; }
            EXIF.getData(file, function() {
                const allTags = EXIF.getAllTags(this);
                if (Object.keys(allTags).length === 0) { exifOutput.innerHTML = `<p class="text-slate-400">No EXIF data found in this image.</p>`; return; }
                const rows = Object.entries(allTags).map(([k, v]) => `<tr><td class="key">${k}</td><td class="value">${v}</td></tr>`).join('');
                exifOutput.innerHTML = `<table><tbody>${rows}</tbody></table>`;
            });
        };
        fileDropZone.addEventListener('click', () => exifFileInput.click());
        exifFileInput.addEventListener('change', (e) => handleExifFile(e.target.files[0]));
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eName => fileDropZone.addEventListener(eName, e => { e.preventDefault(); e.stopPropagation(); }));
        ['dragenter', 'dragover'].forEach(eName => fileDropZone.addEventListener(eName, () => fileDropZone.classList.add('dragover')));
        ['dragleave', 'drop'].forEach(eName => fileDropZone.addEventListener(eName, () => fileDropZone.classList.remove('dragover')));
        fileDropZone.addEventListener('drop', e => handleExifFile(e.dataTransfer.files[0]));
    }
    </script>
</body>
</html>

